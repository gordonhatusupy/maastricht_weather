<html>

    <head>
        <script src="d3.min.js"></script>
        <style>
          .container{
            margin-left: auto;
            margin-right: auto;
            width: 960px;
          }
        </style>
    </head>
    
    <body>
        <script>
            d3.csv('KNMI_20140101.csv', function(data){

                var winddata = d3.nest()
                                .key(function(d){
                                    return d.YYYYMMDD;
                                })
                                .sortKeys(d3.ascending)
                                .entries(data)

                                console.log(winddata);

                var h = 500;
                var w = 960;
                var padding = 20;

        // Set up colorscale
                var ext = d3.extent(winddata, function(d){
                  return parseInt(d.values[0].DDVEC);
                });

                var color = d3.scale.linear()
                    .domain([ext[0], ext[1]])
                    .range(["#00BDCD", "#00FFCE"]);

        // Radius scale

                var rScale = d3.scale.linear()
                     .domain([0, ext[1]])
                     .range([2, 8]);

        // Set up scales
                var xScale = d3.scale.linear()
                     .domain([0, winddata.length])
                     .range([padding, w - padding]);

                var yScale = d3.scale.linear()
                     .domain([0, ext[1]])
                     .range([h - padding, padding]);

                console.log(ext);

                var svg = d3.select('body')
                    .append('svg')
                    .attr('class', 'container')
                    .attr('height', h)
                    .attr('width', w);

                var groups = d3.select('svg')
                    .selectAll('g')
                    .data(winddata)
                    .enter()
                    .append('g')
                    .attr('transform', function(d, i){
                        return 'translate(' + xScale(i) + ',0)';
                    })

                groups.append('circle')
                    .attr('r', function(d, i){
                      return rScale(parseInt(d.values[0].DDVEC));
                    })
                    .attr('opacity', 0.6)
                    .attr('fill', function(d){
                      return color(parseInt(d.values[0].DDVEC));
                    })
                    .attr('cy', function(d, i){
                        return yScale(parseInt(d.values[0].DDVEC));
                    })

            });
        
        </script>
    </body>

    

</html>